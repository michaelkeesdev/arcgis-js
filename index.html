<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <title>ArcGIS API for JavaScript Tutorials: Display a map</title>

    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>

    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.21/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.21/"></script>

    <script>
      require([
        'esri/config',
        'esri/Map',
        'esri/views/SceneView',
        'esri/views/MapView',
        'esri/layers/FeatureLayer',
        'esri/Graphic',
        'esri/renderers/Renderer',
        'esri/symbols/SimpleMarkerSymbol',
        'esri/renderers/SimpleRenderer',
        'esri/geometry/Point',
        'esri/PopupTemplate',
        'esri/renderers/ClassBreaksRenderer',
        'esri/renderers/support/ClassBreakInfo',
        'esri/symbols/CIMSymbol',
      ], function (
        esriConfig,
        Map,
        SceneView,
        MapView,
        FeatureLayer,
        Graphic,
        Renderer,
        SimpleRenderer,
        SimpleMarkerSymbol,
        Point,
        PopupTemplate,
        ClassBreakRenderer,
        ClassBreakInfo,
        CIMSymbol
      ) {
        esriConfig.fontsUrl = './assets/font/';
        console.log('esriConfig', esriConfig);
        const map = new Map({
          basemap: 'topo', // Basemap layer service
        });
        const view = new MapView({
          map: map,
          center: [4.308342, 51.27658], // Longitude, latitude
          zoom: 13, // Zoom level
          container: 'viewDiv', // Div element
        });
        const graphic1 = new Graphic({
          ObjectID: 1,
          attributes: {
            length: 100,
          },
          geometry: {
            type: 'point',
            x: 4.308342,
            y: 51.27658,
          },
        });
        const graphic2 = new Graphic({
          ObjectID: 2,
          attributes: {
            length: 10,
          },
          geometry: {
            type: 'point',
            x: 4.304352,
            y: 51.24758,
          },
        });
        const layer = new FeatureLayer({
          id: 'layer',
          source: [graphic1, graphic2],
          objectIdField: 'ObjectID',
          geometryType: 'point',
          fields: [
            {
              name: 'ObjectID',
              alias: 'ObjectID',
              type: 'oid',
            },
            {
              name: 'length',
              alias: 'Length',
              type: 'integer',
            },
            {
              name: 'cluster_count',
              type: 'integer',
            },
          ],
          renderer: {
            id: 'DUKDALF_SIMPLE_CIM_RENDERER',
            type: 'simple',
            symbol: {
              type: 'text', // autocasts as new TextSymbol()
              color: 'white',
              haloColor: 'black',
              haloSize: '5px',
              text: 'O',
              xoffset: 3,
              yoffset: 3,
              font: {
                // autocasts as new Font()
                size: 12,
                weight: 'bold',
              },
            },
          },
          popupTemplate: {
            title: '{ObjectId} | {length}',
          },
        });
        view.map.layers.add(layer);
        console.log(view.map.layers);
      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
  </body>
</html>
